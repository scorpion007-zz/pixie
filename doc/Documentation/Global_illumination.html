<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="keywords" content="Documentation/Global illumination" />
<link rel="shortcut icon" href="favicon.ico" />
		<title>Documentation/Global illumination - PixieWiki</title>
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "../css/main.css?7"; /*]]>*/</style>
		<link rel="stylesheet" type="text/css"  href="../css/commonPrint.css" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "../css/IE50Fixes.css";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "../css/IE55Fixes.css";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "../css/IE60Fixes.css";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "../css/IE70Fixes.css?1";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="../css/IEFixes.js"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		<script type="text/javascript">var skin = 'monobook';var stylepath = '/pixiewiki/skins';</script>
		<script type="text/javascript" src="../css/wikibits.js"><!-- wikibits js --></script>
		<script type="text/javascript" src="../css/WikiExtraJs.js"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "../css/MediaWiki_Common.css";
@import "../css/MediaWiki_Monobook.css";
@import "../css/WikiExtraCss.css";
/*]]>*/</style>
		<!-- Head Scripts -->
			</head>
<body  class="ns-0 ltr">
 <div id="titleBar"></div>
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="contentTop"></a>
				<h1 class="firstHeading">Documentation/Global illumination</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From PixieWiki</h3>
			<div id="contentSub"><span class="subpages">&lt; <a href="../Documentation.html" title="Documentation">Documentation</a></span></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p><br />
Pixie supports global illumination and photon mapping. The mechanism for
global illumination is very similar to the new extensions introduced with PrMan
11.
</p><p><br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../NotSupportedStatic.html" title="Edit section: Photon Mapping">edit</a>]</div><a name="Photon_Mapping"></a><h2> Photon Mapping </h2>
<p>Photon mapping can be used to get a coarse approximation to the incident irradiance at a particular point. Note that since photon maps are not very accurate, this is only a very coarse approximation. This means photon maps should only be used after the first bounce when the influence of the
incident irradiance estimate on the screen is low. Image on the left is a direct visualization of the photon map. Notice the non uniform shading. The
rightmost image is computed using irradiance caching and using photon maps only for the second bounce. You should use photon maps with irradiance
caches. In a separate pass, you should first compute the photon map. You should use the new photon hider for this:
</p>
<pre>Hider "photon" "emit" 1000000
WorldBegin
Attribute "photon""globalmap" "global.gpm"
...
WorldEnd
</pre>
<p><br />
</p>
<table>
<tr>
<td> <a href="images/Docs_DirectPhoton.jpg" class="image" title=""><img src="../thumbs/4/4e/Docs_DirectPhoton.jpg/320px-Docs_DirectPhoton.jpg" alt="" width="320" height="320" longdesc="images/Docs_DirectPhoton.jpg" /></a> </td><td> <a href="images/Docs_ex5_beauty.jpg" class="image" title=""><img src="../thumbs/4/40/Docs_ex5_beauty.jpg/320px-Docs_ex5_beauty.jpg" alt="" width="320" height="320" longdesc="images/Docs_ex5_beauty.jpg" /></a>
</td></tr></table>
<p>The rib fragment above causes one global photon map to be saved into <tt>global.gpm</tt>. You can attach different photon maps to different objects. You can also use <tt>causticmap</tt> instead of <tt>globalmap</tt> to create a caustics photon map. The only difference between them is that the caustic photon map only contains photons that hit a reflective / refractive (specular) object first. To look up a previously created photon map, you can use the <tt>photonmap</tt> shading language command:
</p>
<pre>color photonmap(string map,point P,normal N,...);
</pre>
<p><br />
where <tt>map</tt> is the name of the photon map (e.g. <tt>global.gpm</tt>),<tt>P</tt> is the lookup point and <tt>N</tt> is the lookup normal. The following optional parameters can also be passed:
</p>
<table class="wikitable">
<tr>
<td> <tt>uniform float estimator</tt></td><td>	 The number of photons to use for lookup
</td></tr>
<tr>
<td> <tt>niform float maxRadius</tt></td><td>		 The maximum lookup radius
</td></tr></table>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../NotSupportedStatic.html" title="Edit section: Caustics">edit</a>]</div><a name="Caustics"></a><h2> Caustics </h2>
<p>Caustics can be generated by directly visualizing the caustics photon maps that Pixie generates. Notice that since these photon maps are visualized directly, they need to have lots of photons. Figures below demonstrate this effect.
</p><p><br />
</p>
<table>
<tr>
<td> <a href="images/Docs_Caustic1.jpg" class="image" title=""><img src="../thumbs/5/52/Docs_Caustic1.jpg/320px-Docs_Caustic1.jpg" alt="" width="320" height="240" longdesc="images/Docs_Caustic1.jpg" /></a> </td><td> <a href="images/Docs_Caustic2.jpg" class="image" title=""><img src="../thumbs/7/7c/Docs_Caustic2.jpg/320px-Docs_Caustic2.jpg" alt="" width="320" height="240" longdesc="images/Docs_Caustic2.jpg" /></a>
</td></tr></table>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../NotSupportedStatic.html" title="Edit section: Irradiance Caching">edit</a>]</div><a name="Irradiance_Caching"></a><h2> Irradiance Caching </h2>
<p>Pixie can compute occlusion and/or irradiance values sparsely and interpolate them for the final rendering. This allows fast and accurate diffuse interreflections without noise. The following two shading language commands can be used:
</p>
<pre>color indirectdiffuse(point P,normal N,float numSamples,...);
float occlusion(point P,normal N,float numSamples,...);

</pre>
<p>The <tt>indirectdiffuse</tt> command computes diffuse interreflection. It will either interpolate using the previous diffuse interreflection samples nearby, or compute a new sample.  The <tt>occlusion</tt> computes the coverage (i.e.: the fraction of the hemisphere that is occluded) using the same method. The only difference between them is that <tt>indirectdiffuse</tt> shades the rays that are shot for computing a sample whereas <tt>occlusion</tt> doesn't. This makes <tt>occlusion</tt> faster than <tt>indirectdiffuse</tt>. The following optional parameters can be pass to both of these commands:
</p>
<table class="wikitable">
<tr>
<td> <tt>uniform float minR</tt></td><td>			The closest distance between samples
</td></tr>
<tr>
<td> <tt>uniform float maxR</tt></td><td>			The farthest distance between samples
</td></tr>
<tr>
<td> <tt>varying float occlusion</tt></td><td>	The occlusion value (output)
</td></tr>
<tr>
<td> <tt>varying color irradiance</tt></td><td>	The irradiance value (output)
</td></tr>
<tr>
<td> <tt>string environmentmap</tt></td><td>	An environment map to be consulted for rays which don't hit anything
</td></tr></table>
<p>Notice that you can obtain the occlusion value from <tt>indirectdiffuse</tt>
and vice-versa:
</p><p><br />
</p>
<pre>float oc;
vector ic;
ic =indirectdiffuse(P,N,256,"occlusion",oc);
</pre>
<p>Since in a single pass, the renderer will be forced to do some extrapolation, the generated image may have blocky artifacts. These can be avoided by doing another pass using the irradiance cache computed by the previous pass. The figures below demonstrate the extrapolation artifacts and the image computed after a second pass:
</p>
<table>
<tr>
<td> <a href="images/Docs_ex1_precompute.jpg" class="image" title=""><img src="../thumbs/e/e6/Docs_ex1_precompute.jpg/320px-Docs_ex1_precompute.jpg" alt="" width="320" height="240" longdesc="images/Docs_ex1_precompute.jpg" /></a> </td><td> <a href="images/Docs_ex1_beauty.jpg" class="image" title=""><img src="../thumbs/4/47/Docs_ex1_beauty.jpg/320px-Docs_ex1_beauty.jpg" alt="" width="320" height="240" longdesc="images/Docs_ex1_beauty.jpg" /></a>
</td></tr></table>
<p><br />
The image on the left is computed in the first pass and suffers from blocky artifacts due to extrapolation. The image on the right is computed in the second pass. This scene contains only one light source shader: <tt>ambientocclusion</tt> (available in the <tt>shaders</tt> directory).
</p><p>Figures below further demonstrate the global illumination capabilities of Pixie.
</p>
<table>
<tr>
<td> <a href="images/Docs_ex3_beauty.jpg" class="image" title=""><img src="../thumbs/1/1f/Docs_ex3_beauty.jpg/320px-Docs_ex3_beauty.jpg" alt="" width="320" height="240" longdesc="images/Docs_ex3_beauty.jpg" /></a> </td><td> <a href="images/Docs_ex3g_beauty.jpg" class="image" title=""><img src="../thumbs/5/54/Docs_ex3g_beauty.jpg/320px-Docs_ex3g_beauty.jpg" alt="" width="320" height="240" longdesc="images/Docs_ex3g_beauty.jpg" /></a>
</td></tr></table>
<p>These images were created using irradiance caching via <tt>indirectdiffuse</tt>. This scene contains only one light source shader: <tt>ambientindirect</tt> (available in the <tt>shaders</tt> directory).
</p><div class="printfooter">
Retrieved from "<a href="http://www.george-graphics.co.uk/pixiewiki/index.php/Documentation/Global_illumination">http://www.george-graphics.co.uk/pixiewiki/index.php/Documentation/Global_illumination</a>"</div>
			<div id="catlinks"><p class='catlinks'><a href="../NotSupportedStatic.html" title="Special:Categories">Category</a>: <span dir='ltr'><a href="../Category_Documentation.html" title="Category:Documentation">Documentation</a></span></p></div>			<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<ul>
				 <li id="ca-nstab-main" class="selected"><a href="../Documentation/Global_illumination.html">Article</a></li>
				 <li id="ca-talk" class="new"><a href="../NotSupportedStatic.html">Discussion</a></li>
				 <li id="ca-edit"><a href="../NotSupportedStatic.html">Edit</a></li>
				 <li id="ca-history"><a href="../NotSupportedStatic.html">History</a></li>
		</ul>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="../NotSupportedStatic.html">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/pixiewiki/skins/common/images/wiki.png);" href="../NotIncludedStatic.html" title="Main Page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="../NotIncludedStatic.html">Main Page</a></li>
				<li id="n-portal"><a href="../NotSupportedStatic.html">Community portal</a></li>
				<li id="n-currentevents"><a href="../NotIncludedStatic.html">Current events</a></li>
				<li id="n-recentchanges"><a href="../NotSupportedStatic.html">Recent changes</a></li>
				<li id="n-randompage"><a href="../NotSupportedStatic.html">Random page</a></li>
				<li id="n-help"><a href="../NotSupportedStatic.html">Help</a></li>
			</ul>
		</div>
	</div>
		<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="../NotSupportedStatic.html" id="searchform"><div>
				<input id="searchInput" name="search" type="text" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" value="Search" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="../NotSupportedStatic.html">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="../NotSupportedStatic.html">Related changes</a></li>
<li id="t-upload"><a href="../NotSupportedStatic.html">Upload file</a></li>
<li id="t-specialpages"><a href="../NotSupportedStatic.html">Special pages</a></li>
				<li id="t-print"><a href="../NotSupportedStatic.html">Printable version</a></li>				<li id="t-permalink"><a href="/pixiewiki/index.php?title=Documentation/Global_illumination&amp;oldid=2207">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../css/images/poweredby_mediawiki_88x31.png" alt="MediaWiki" /></a></div>
			<ul id="f-list">
				<li id="f-lastmod"> This page was last modified 15:38, 28 August 2006.</li>
				<li id="f-viewcount">This page has been accessed 320 times.</li>
				<li id="f-privacy"><a href="../NotSupportedStatic.html" title="PixieWiki:Privacy policy">Privacy policy</a></li>
				<li id="f-about"><a href="../NotSupportedStatic.html" title="PixieWiki:About">About PixieWiki</a></li>
				<li id="f-disclaimer"><a href="../NotSupportedStatic.html" title="PixieWiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
	<script type="text/javascript"> if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served by mercury.svr9-speedyservers.com in 0.49 secs. -->
</body></html>
